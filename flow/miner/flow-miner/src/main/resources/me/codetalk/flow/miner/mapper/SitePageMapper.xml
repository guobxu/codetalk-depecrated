<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="me.codetalk.flow.miner.mapper.SitePageMapper">

	<resultMap type="me.codetalk.flow.miner.pojo.SitePage" id="sitePageMap">
		<result property="id" column="page_id"></result>
		<result property="url" column="page_url"></result>
		<result property="status" column="page_status"></result>
		<result property="errorMsg" column="error_msg"></result>
		<result property="siteId" column="site_id"></result>
		<result property="entityTypeId" column="entity_type_id"></result>
		<result property="lastUpdate" column="last_update"></result>
		<result property="createDate" column="create_date"></result>
	</resultMap>

	<select id="insertPages" parameterType="java.util.List">
		insert into site_pages (page_id, page_url, site_id, entity_type_id) values 
		<foreach collection ="pageList" item="page" index= "index" separator =",">(#{page.id}, #{page.url}, #{page.siteId}, #{page.entityTypeId})</foreach>
	</select>
	
	<update id="updatePageStatus" parameterType="me.codetalk.flow.miner.pojo.SitePage">
		update site_pages 
		   set last_update = CURRENT_TIMESTAMP
		   <if test="status != null">
			 , page_status = #{status}	
		   </if>
		   <if test="errorMsg != null">
			 , error_msg = #{errorMsg}	
		   </if>
		 where page_id = #{id} 
	</update>
	
	<select id="selectUrlIn" parameterType="java.util.List" resultType="String">
		select page_url from site_pages 
		 where page_url in (
		 	<foreach collection ="urlList" item="url" index= "index" separator =",">#{url}</foreach>
		 )
	</select>
		
</mapper>











